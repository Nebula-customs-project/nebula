package pse.nebula.worldview.infrastructure.adapter.persistence;

import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.springframework.context.annotation.Primary;
import org.springframework.stereotype.Repository;
import pse.nebula.worldview.domain.model.Coordinate;
import pse.nebula.worldview.domain.model.DrivingRoute;
import pse.nebula.worldview.domain.port.outbound.RouteRepository;
import pse.nebula.worldview.infrastructure.adapter.persistence.entity.RouteEntity;
import pse.nebula.worldview.infrastructure.adapter.persistence.jpa.JpaRouteRepository;
import pse.nebula.worldview.infrastructure.adapter.persistence.mapper.RouteEntityMapper;

import jakarta.annotation.PostConstruct;
import org.springframework.transaction.annotation.Transactional;

import java.util.*;

/**
 * PostgreSQL implementation of RouteRepository.
 * 
 * Stores 8 predefined routes to Porsche Zentrum Stuttgart.
 * All waypoints follow actual roads (fetched from OSRM and hardcoded).
 * 
 * Destination: Porsche Zentrum Stuttgart
 * Address: Porschestraße 1, 70435 Stuttgart, Germany
 * Coordinates: 48.8354, 9.1520
 */
@Slf4j
@Repository
@Primary
@RequiredArgsConstructor
public class PostgresRouteRepository implements RouteRepository {

    private static final Coordinate DEALERSHIP = new Coordinate(48.8354, 9.1520);

    private final JpaRouteRepository jpaRouteRepository;
    private final RouteEntityMapper routeEntityMapper;

    @PostConstruct
    @Transactional
    public void initializeRoutes() {
        if (jpaRouteRepository.count() == 0) {
            log.info("Initializing predefined routes in database...");
            initializeAllRoutes();
            log.info("Successfully initialized {} routes", jpaRouteRepository.count());
        } else {
            log.info("Routes already exist in database. Found {} routes.", jpaRouteRepository.count());
        }
    }

    private void initializeAllRoutes() {
        saveRoute(createRoute1FromLudwigsburg());
        saveRoute(createRoute2FromFavoritepark());
        saveRoute(createRoute3FromKornwestheim());
        saveRoute(createRoute4FromBoblingen());
        saveRoute(createRoute5FromReutlingen());
        saveRoute(createRoute6FromWaiblingen());
        saveRoute(createRoute7FromFellbach());
        saveRoute(createRoute8FromEsslingen());
    }

    private void saveRoute(DrivingRoute route) {
        RouteEntity entity = routeEntityMapper.toEntity(route);
        jpaRouteRepository.save(entity);
        log.info("Saved route: {} with {} waypoints", route.name(), route.waypoints().size());
    }

    // ==================== ROUTE 1: Ludwigsburg Schloss ====================
    private DrivingRoute createRoute1FromLudwigsburg() {
        List<Coordinate> waypoints = Arrays.asList(
            new Coordinate(48.897326, 9.192837),
            new Coordinate(48.897947, 9.192806),
            new Coordinate(48.898756, 9.193656),
            new Coordinate(48.898695, 9.193821),
            new Coordinate(48.898314, 9.193801),
            new Coordinate(48.897165, 9.193862),
            new Coordinate(48.896498, 9.193898),
            new Coordinate(48.896204, 9.193931),
            new Coordinate(48.896091, 9.193918),
            new Coordinate(48.895555, 9.193959),
            new Coordinate(48.893932, 9.194035),
            new Coordinate(48.893287, 9.194116),
            new Coordinate(48.892774, 9.194134),
            new Coordinate(48.891782, 9.194181),
            new Coordinate(48.891291, 9.194209),
            new Coordinate(48.890819, 9.194231),
            new Coordinate(48.889933, 9.194276),
            new Coordinate(48.889237, 9.194300),
            new Coordinate(48.888464, 9.194278),
            new Coordinate(48.887679, 9.194310),
            new Coordinate(48.886122, 9.194390),
            new Coordinate(48.884519, 9.194471),
            new Coordinate(48.883975, 9.194512),
            new Coordinate(48.882536, 9.194648),
            new Coordinate(48.881503, 9.195023),
            new Coordinate(48.878720, 9.196281),
            new Coordinate(48.876770, 9.196785),
            new Coordinate(48.874977, 9.196773),
            new Coordinate(48.874069, 9.196658),
            new Coordinate(48.872227, 9.196453),
            new Coordinate(48.871103, 9.196470),
            new Coordinate(48.868739, 9.196915),
            new Coordinate(48.867099, 9.197276),
            new Coordinate(48.866515, 9.197310),
            new Coordinate(48.865732, 9.197209),
            new Coordinate(48.864444, 9.196793),
            new Coordinate(48.862627, 9.196174),
            new Coordinate(48.861619, 9.195939),
            new Coordinate(48.860113, 9.195908),
            new Coordinate(48.858707, 9.195995),
            new Coordinate(48.857769, 9.195970),
            new Coordinate(48.856952, 9.195819),
            new Coordinate(48.855570, 9.195229),
            new Coordinate(48.854235, 9.194188),
            new Coordinate(48.853179, 9.192886),
            new Coordinate(48.852655, 9.192007),
            new Coordinate(48.852085, 9.190806),
            new Coordinate(48.851279, 9.188619),
            new Coordinate(48.850614, 9.186729),
            new Coordinate(48.850060, 9.185411),
            new Coordinate(48.849669, 9.184628),
            new Coordinate(48.848833, 9.183281),
            new Coordinate(48.848016, 9.182233),
            new Coordinate(48.847077, 9.181236),
            new Coordinate(48.845809, 9.180119),
            new Coordinate(48.844776, 9.179245),
            new Coordinate(48.844259, 9.178770),
            new Coordinate(48.843634, 9.178140),
            new Coordinate(48.842754, 9.177111),
            new Coordinate(48.841773, 9.175382),
            new Coordinate(48.841356, 9.174509),
            new Coordinate(48.841212, 9.173926),
            new Coordinate(48.841179, 9.173203),
            new Coordinate(48.841258, 9.172611),
            new Coordinate(48.841476, 9.171729),
            new Coordinate(48.841904, 9.170003),
            new Coordinate(48.842065, 9.168650),
            new Coordinate(48.842059, 9.167778),
            new Coordinate(48.841936, 9.166710),
            new Coordinate(48.841662, 9.165663),
            new Coordinate(48.841179, 9.163351),
            new Coordinate(48.840774, 9.160644),
            new Coordinate(48.840733, 9.159503),
            new Coordinate(48.840735, 9.159018),
            new Coordinate(48.840845, 9.158039),
            new Coordinate(48.840774, 9.157267),
            new Coordinate(48.840462, 9.156787),
            new Coordinate(48.840084, 9.156706),
            new Coordinate(48.839441, 9.156947),
            new Coordinate(48.839233, 9.156885),
            new Coordinate(48.838848, 9.155328),
            new Coordinate(48.838723, 9.155187),
            new Coordinate(48.838367, 9.155342),
            new Coordinate(48.838050, 9.155498),
            new Coordinate(48.837557, 9.155741),
            new Coordinate(48.837295, 9.155920),
            new Coordinate(48.836844, 9.156278),
            new Coordinate(48.835951, 9.156696),
            new Coordinate(48.835762, 9.156489),
            new Coordinate(48.835635, 9.155845),
            new Coordinate(48.835284, 9.153981),
            new Coordinate(48.835095, 9.152895),
            new Coordinate(48.835049, 9.152395),
            new Coordinate(48.835148, 9.152177),
            DEALERSHIP
        );
        return createRoute("route-1", "Ludwigsburg Schloss Route",
            "From Ludwigsburg Palace - Scenic castle start (9.7 km, ~12 min)",
            waypoints, 9700, 720);
    }

    // ==================== ROUTE 2: Favoritepark ====================
    private DrivingRoute createRoute2FromFavoritepark() {
        List<Coordinate> waypoints = Arrays.asList(
            new Coordinate(48.907997, 9.179710),
            new Coordinate(48.907718, 9.179485),
            new Coordinate(48.907819, 9.179131),
            new Coordinate(48.907989, 9.178840),
            new Coordinate(48.908452, 9.177907),
            new Coordinate(48.908487, 9.177458),
            new Coordinate(48.908455, 9.175672),
            new Coordinate(48.908096, 9.173840),
            new Coordinate(48.907862, 9.173145),
            new Coordinate(48.908078, 9.172812),
            new Coordinate(48.908640, 9.172185),
            new Coordinate(48.909527, 9.171074),
            new Coordinate(48.910155, 9.170176),
            new Coordinate(48.911799, 9.167889),
            new Coordinate(48.912299, 9.167251),
            new Coordinate(48.913225, 9.165913),
            new Coordinate(48.913806, 9.165111),
            new Coordinate(48.915915, 9.162207),
            new Coordinate(48.917455, 9.160336),
            new Coordinate(48.918880, 9.158924),
            new Coordinate(48.919339, 9.158426),
            new Coordinate(48.921029, 9.156682),
            new Coordinate(48.921049, 9.155933),
            new Coordinate(48.920851, 9.155560),
            new Coordinate(48.920492, 9.155286),
            new Coordinate(48.919989, 9.155401),
            new Coordinate(48.919188, 9.156003),
            new Coordinate(48.917894, 9.155635),
            new Coordinate(48.915839, 9.154827),
            new Coordinate(48.913475, 9.154393),
            new Coordinate(48.909886, 9.154385),
            new Coordinate(48.908069, 9.154412),
            new Coordinate(48.905079, 9.154406),
            new Coordinate(48.903728, 9.154393),
            new Coordinate(48.902330, 9.154196),
            new Coordinate(48.900067, 9.153382),
            new Coordinate(48.897155, 9.151854),
            new Coordinate(48.896206, 9.151359),
            new Coordinate(48.893557, 9.149962),
            new Coordinate(48.891370, 9.148813),
            new Coordinate(48.887252, 9.146653),
            new Coordinate(48.885573, 9.145783),
            new Coordinate(48.883164, 9.144504),
            new Coordinate(48.881063, 9.143297),
            new Coordinate(48.879171, 9.142002),
            new Coordinate(48.878528, 9.141521),
            new Coordinate(48.876669, 9.139983),
            new Coordinate(48.875106, 9.138633),
            new Coordinate(48.873793, 9.137500),
            new Coordinate(48.873073, 9.136880),
            new Coordinate(48.871845, 9.135823),
            new Coordinate(48.869401, 9.133717),
            new Coordinate(48.867272, 9.131885),
            new Coordinate(48.865507, 9.130361),
            new Coordinate(48.864058, 9.129153),
            new Coordinate(48.862610, 9.128107),
            new Coordinate(48.860500, 9.126754),
            new Coordinate(48.858784, 9.125656),
            new Coordinate(48.857713, 9.124975),
            new Coordinate(48.855869, 9.123808),
            new Coordinate(48.854900, 9.123021),
            new Coordinate(48.853684, 9.122202),
            new Coordinate(48.853004, 9.121672),
            new Coordinate(48.852594, 9.121149),
            new Coordinate(48.852271, 9.120917),
            new Coordinate(48.851843, 9.120826),
            new Coordinate(48.851509, 9.120763),
            new Coordinate(48.850738, 9.120258),
            new Coordinate(48.850549, 9.119870),
            new Coordinate(48.850566, 9.119370),
            new Coordinate(48.850775, 9.119037),
            new Coordinate(48.851091, 9.118984),
            new Coordinate(48.851365, 9.119272),
            new Coordinate(48.851438, 9.119731),
            new Coordinate(48.851192, 9.120524),
            new Coordinate(48.849751, 9.122640),
            new Coordinate(48.848147, 9.125315),
            new Coordinate(48.845433, 9.130847),
            new Coordinate(48.843660, 9.133858),
            new Coordinate(48.842254, 9.135910),
            new Coordinate(48.841189, 9.137386),
            new Coordinate(48.840701, 9.138285),
            new Coordinate(48.840157, 9.139658),
            new Coordinate(48.839536, 9.141605),
            new Coordinate(48.837757, 9.146238),
            new Coordinate(48.837249, 9.147284),
            new Coordinate(48.836636, 9.148523),
            new Coordinate(48.835834, 9.150158),
            new Coordinate(48.835042, 9.151742),
            new Coordinate(48.834807, 9.151974),
            new Coordinate(48.834765, 9.152383),
            new Coordinate(48.834968, 9.152391),
            new Coordinate(48.835148, 9.152177),
            DEALERSHIP
        );
        return createRoute("route-2", "Favoritepark Route",
            "From SWLB Mobilität near Favoritepark (14.3 km, ~13 min)",
            waypoints, 14300, 780);
    }

    // ==================== ROUTE 3: Kornwestheim ====================
    private DrivingRoute createRoute3FromKornwestheim() {
        List<Coordinate> waypoints = Arrays.asList(
            new Coordinate(48.859809, 9.185563),
            new Coordinate(48.859634, 9.185540),
            new Coordinate(48.859362, 9.185498),
            new Coordinate(48.859119, 9.185467),
            new Coordinate(48.858882, 9.185435),
            new Coordinate(48.858455, 9.185390),
            new Coordinate(48.857700, 9.185296),
            new Coordinate(48.857494, 9.185271),
            new Coordinate(48.857254, 9.185238),
            new Coordinate(48.856608, 9.185147),
            new Coordinate(48.856087, 9.185072),
            new Coordinate(48.855758, 9.185033),
            new Coordinate(48.855497, 9.184999),
            new Coordinate(48.855188, 9.184953),
            new Coordinate(48.854866, 9.184907),
            new Coordinate(48.854777, 9.184897),
            new Coordinate(48.854760, 9.184799),
            new Coordinate(48.854707, 9.184737),
            new Coordinate(48.854621, 9.184754),
            new Coordinate(48.854574, 9.184866),
            new Coordinate(48.854491, 9.184852),
            new Coordinate(48.854271, 9.184840),
            new Coordinate(48.853980, 9.184830),
            new Coordinate(48.853742, 9.184812),
            new Coordinate(48.853447, 9.184784),
            new Coordinate(48.853214, 9.184762),
            new Coordinate(48.853125, 9.184752),
            new Coordinate(48.852934, 9.184733),
            new Coordinate(48.852471, 9.184671),
            new Coordinate(48.851765, 9.184465),
            new Coordinate(48.851456, 9.184360),
            new Coordinate(48.851111, 9.184305),
            new Coordinate(48.850781, 9.184314),
            new Coordinate(48.850581, 9.184365),
            new Coordinate(48.850451, 9.184410),
            new Coordinate(48.849994, 9.184493),
            new Coordinate(48.849813, 9.184384),
            new Coordinate(48.849269, 9.183615),
            new Coordinate(48.848805, 9.183021),
            new Coordinate(48.848344, 9.182529),
            new Coordinate(48.848016, 9.182233),
            new Coordinate(48.847465, 9.181626),
            new Coordinate(48.846584, 9.180782),
            new Coordinate(48.845809, 9.180119),
            new Coordinate(48.845553, 9.179906),
            new Coordinate(48.844558, 9.179051),
            new Coordinate(48.844259, 9.178770),
            new Coordinate(48.843844, 9.178363),
            new Coordinate(48.843281, 9.177751),
            new Coordinate(48.842754, 9.177111),
            new Coordinate(48.842395, 9.176444),
            new Coordinate(48.841586, 9.175050),
            new Coordinate(48.841356, 9.174509),
            new Coordinate(48.841251, 9.174140),
            new Coordinate(48.841180, 9.173631),
            new Coordinate(48.841179, 9.173203),
            new Coordinate(48.841224, 9.172815),
            new Coordinate(48.841309, 9.172369),
            new Coordinate(48.841476, 9.171729),
            new Coordinate(48.841806, 9.170441),
            new Coordinate(48.842003, 9.169353),
            new Coordinate(48.842065, 9.168650),
            new Coordinate(48.842070, 9.168140),
            new Coordinate(48.842034, 9.167448),
            new Coordinate(48.841936, 9.166710),
            new Coordinate(48.841786, 9.165970),
            new Coordinate(48.841406, 9.164471),
            new Coordinate(48.841179, 9.163351),
            new Coordinate(48.840919, 9.161768),
            new Coordinate(48.840730, 9.160214),
            new Coordinate(48.840733, 9.159503),
            new Coordinate(48.840724, 9.159192),
            new Coordinate(48.840741, 9.158954),
            new Coordinate(48.840845, 9.158039),
            new Coordinate(48.840835, 9.157498),
            new Coordinate(48.840699, 9.157075),
            new Coordinate(48.840462, 9.156787),
            new Coordinate(48.840187, 9.156694),
            new Coordinate(48.839858, 9.156751),
            new Coordinate(48.839441, 9.156947),
            new Coordinate(48.839301, 9.156926),
            new Coordinate(48.839009, 9.156022),
            new Coordinate(48.838848, 9.155328),
            new Coordinate(48.838766, 9.155206),
            new Coordinate(48.838652, 9.155201),
            new Coordinate(48.838367, 9.155342),
            new Coordinate(48.838205, 9.155422),
            new Coordinate(48.837931, 9.155557),
            new Coordinate(48.837557, 9.155741),
            new Coordinate(48.837432, 9.155810),
            new Coordinate(48.837157, 9.156023),
            new Coordinate(48.836844, 9.156278),
            new Coordinate(48.836475, 9.156459),
            new Coordinate(48.835908, 9.156716),
            new Coordinate(48.835762, 9.156489),
            new Coordinate(48.835693, 9.156134),
            new Coordinate(48.835537, 9.155378),
            new Coordinate(48.835284, 9.153981),
            new Coordinate(48.835176, 9.153366),
            new Coordinate(48.835053, 9.152575),
            new Coordinate(48.835049, 9.152395),
            new Coordinate(48.835068, 9.152165),
            DEALERSHIP
        );
        return createRoute("route-3", "Kornwestheim Route",
            "From Kornwestheim - Quick route (4.7 km, ~7 min)",
            waypoints, 4700, 420);
    }

    // ==================== ROUTE 4: Böblingen ====================
    private DrivingRoute createRoute4FromBoblingen() {
        List<Coordinate> waypoints = Arrays.asList(
            new Coordinate(48.685973, 9.014334),
            new Coordinate(48.686506, 9.013079),
            new Coordinate(48.687698, 9.011613),
            new Coordinate(48.688667, 9.014440),
            new Coordinate(48.689491, 9.017871),
            new Coordinate(48.690284, 9.019233),
            new Coordinate(48.691996, 9.021894),
            new Coordinate(48.692580, 9.024011),
            new Coordinate(48.693495, 9.027642),
            new Coordinate(48.694601, 9.029641),
            new Coordinate(48.694716, 9.030909),
            new Coordinate(48.695230, 9.031394),
            new Coordinate(48.696648, 9.030701),
            new Coordinate(48.700054, 9.032224),
            new Coordinate(48.701700, 9.033591),
            new Coordinate(48.702413, 9.035002),
            new Coordinate(48.703422, 9.039691),
            new Coordinate(48.703897, 9.043109),
            new Coordinate(48.704797, 9.046835),
            new Coordinate(48.705950, 9.049340),
            new Coordinate(48.707633, 9.051614),
            new Coordinate(48.708988, 9.052762),
            new Coordinate(48.710557, 9.053575),
            new Coordinate(48.712131, 9.053923),
            new Coordinate(48.714297, 9.053925),
            new Coordinate(48.715492, 9.054134),
            new Coordinate(48.716393, 9.054438),
            new Coordinate(48.717933, 9.055194),
            new Coordinate(48.719236, 9.056236),
            new Coordinate(48.720318, 9.057512),
            new Coordinate(48.721423, 9.059162),
            new Coordinate(48.722863, 9.061617),
            new Coordinate(48.724055, 9.063838),
            new Coordinate(48.724538, 9.065417),
            new Coordinate(48.724805, 9.068715),
            new Coordinate(48.725027, 9.070041),
            new Coordinate(48.725415, 9.070779),
            new Coordinate(48.726033, 9.071205),
            new Coordinate(48.726908, 9.071018),
            new Coordinate(48.727572, 9.069968),
            new Coordinate(48.727698, 9.068543),
            new Coordinate(48.727482, 9.066528),
            new Coordinate(48.727103, 9.064971),
            new Coordinate(48.727971, 9.059102),
            new Coordinate(48.730307, 9.052438),
            new Coordinate(48.735283, 9.042138),
            new Coordinate(48.737807, 9.038626),
            new Coordinate(48.740040, 9.036670),
            new Coordinate(48.741392, 9.035875),
            new Coordinate(48.742796, 9.035302),
            new Coordinate(48.744227, 9.034953),
            new Coordinate(48.750029, 9.034260),
            new Coordinate(48.759415, 9.033233),
            new Coordinate(48.763332, 9.032557),
            new Coordinate(48.769264, 9.029932),
            new Coordinate(48.772754, 9.027859),
            new Coordinate(48.774567, 9.026066),
            new Coordinate(48.776555, 9.023120),
            new Coordinate(48.779121, 9.017805),
            new Coordinate(48.780579, 9.015362),
            new Coordinate(48.781917, 9.014526),
            new Coordinate(48.783361, 9.014511),
            new Coordinate(48.785483, 9.015829),
            new Coordinate(48.791852, 9.021523),
            new Coordinate(48.798713, 9.032309),
            new Coordinate(48.805111, 9.040914),
            new Coordinate(48.807612, 9.046152),
            new Coordinate(48.810773, 9.054786),
            new Coordinate(48.817107, 9.071540),
            new Coordinate(48.820424, 9.076346),
            new Coordinate(48.826357, 9.081892),
            new Coordinate(48.830953, 9.086324),
            new Coordinate(48.833095, 9.089377),
            new Coordinate(48.835352, 9.094011),
            new Coordinate(48.839910, 9.104635),
            new Coordinate(48.843567, 9.112799),
            new Coordinate(48.846565, 9.117362),
            new Coordinate(48.848774, 9.119845),
            new Coordinate(48.849350, 9.122623),
            new Coordinate(48.846045, 9.129640),
            new Coordinate(48.842254, 9.135910),
            new Coordinate(48.840599, 9.138509),
            new Coordinate(48.838868, 9.143589),
            new Coordinate(48.836832, 9.148127),
            new Coordinate(48.835042, 9.151742),
            new Coordinate(48.834791, 9.152419),
            DEALERSHIP
        );
        return createRoute("route-4", "Böblingen Route",
            "From Böblingen via A81 - Southern approach (29.5 km, ~27 min)",
            waypoints, 29500, 1620);
    }

    // ==================== ROUTE 5: Reutlingen ====================
    private DrivingRoute createRoute5FromReutlingen() {
        List<Coordinate> waypoints = Arrays.asList(
            new Coordinate(48.482700, 9.205242),
            new Coordinate(48.484934, 9.204575),
            new Coordinate(48.486452, 9.205803),
            new Coordinate(48.489364, 9.207612),
            new Coordinate(48.490728, 9.206734),
            new Coordinate(48.491731, 9.205196),
            new Coordinate(48.493178, 9.207014),
            new Coordinate(48.495198, 9.205690),
            new Coordinate(48.496257, 9.205809),
            new Coordinate(48.497925, 9.204686),
            new Coordinate(48.500256, 9.204696),
            new Coordinate(48.501662, 9.205782),
            new Coordinate(48.504013, 9.206237),
            new Coordinate(48.507862, 9.204137),
            new Coordinate(48.513540, 9.202510),
            new Coordinate(48.515205, 9.199541),
            new Coordinate(48.526565, 9.192550),
            new Coordinate(48.532194, 9.191224),
            new Coordinate(48.535756, 9.187904),
            new Coordinate(48.540237, 9.182029),
            new Coordinate(48.543626, 9.177755),
            new Coordinate(48.547332, 9.174095),
            new Coordinate(48.550017, 9.172600),
            new Coordinate(48.553452, 9.172201),
            new Coordinate(48.562707, 9.174419),
            new Coordinate(48.573932, 9.176820),
            new Coordinate(48.587233, 9.169862),
            new Coordinate(48.592667, 9.170693),
            new Coordinate(48.599827, 9.188909),
            new Coordinate(48.609100, 9.204190),
            new Coordinate(48.615780, 9.219979),
            new Coordinate(48.620646, 9.225367),
            new Coordinate(48.626400, 9.227030),
            new Coordinate(48.632788, 9.226570),
            new Coordinate(48.639000, 9.229049),
            new Coordinate(48.649260, 9.232766),
            new Coordinate(48.656684, 9.231945),
            new Coordinate(48.661866, 9.226412),
            new Coordinate(48.664681, 9.217090),
            new Coordinate(48.665781, 9.203348),
            new Coordinate(48.668381, 9.194704),
            new Coordinate(48.672867, 9.188216),
            new Coordinate(48.676212, 9.184919),
            new Coordinate(48.680449, 9.181587),
            new Coordinate(48.683661, 9.179895),
            new Coordinate(48.689045, 9.178656),
            new Coordinate(48.692182, 9.177208),
            new Coordinate(48.694620, 9.174085),
            new Coordinate(48.697894, 9.168706),
            new Coordinate(48.699967, 9.167282),
            new Coordinate(48.701967, 9.166795),
            new Coordinate(48.704166, 9.167506),
            new Coordinate(48.707099, 9.166723),
            new Coordinate(48.706738, 9.163879),
            new Coordinate(48.708521, 9.150887),
            new Coordinate(48.709875, 9.139613),
            new Coordinate(48.708997, 9.129007),
            new Coordinate(48.709353, 9.113891),
            new Coordinate(48.713533, 9.094278),
            new Coordinate(48.717418, 9.083629),
            new Coordinate(48.724692, 9.072050),
            new Coordinate(48.727030, 9.064253),
            new Coordinate(48.730715, 9.051577),
            new Coordinate(48.737959, 9.038471),
            new Coordinate(48.741392, 9.035875),
            new Coordinate(48.744110, 9.034977),
            new Coordinate(48.757780, 9.033402),
            new Coordinate(48.767704, 9.030630),
            new Coordinate(48.773489, 9.027206),
            new Coordinate(48.777474, 9.021311),
            new Coordinate(48.781033, 9.014977),
            new Coordinate(48.783672, 9.014633),
            new Coordinate(48.792427, 9.022375),
            new Coordinate(48.805111, 9.040914),
            new Coordinate(48.810120, 9.052970),
            new Coordinate(48.819478, 9.075212),
            new Coordinate(48.830123, 9.085393),
            new Coordinate(48.834313, 9.091652),
            new Coordinate(48.842182, 9.109927),
            new Coordinate(48.847403, 9.118360),
            new Coordinate(48.849221, 9.123213),
            new Coordinate(48.841906, 9.136360),
            new Coordinate(48.838868, 9.143589),
            new Coordinate(48.835125, 9.151595),
            new Coordinate(48.835148, 9.152177),
            DEALERSHIP
        );
        return createRoute("route-5", "Reutlingen Route",
            "From Alteburgstraße, Reutlingen - Long scenic drive (61.2 km, ~52 min)",
            waypoints, 61200, 3120);
    }

    // ==================== ROUTE 6: Waiblingen ====================
    private DrivingRoute createRoute6FromWaiblingen() {
        List<Coordinate> waypoints = Arrays.asList(
            new Coordinate(48.830400, 9.316487),
            new Coordinate(48.829889, 9.315318),
            new Coordinate(48.829840, 9.315811),
            new Coordinate(48.829896, 9.317055),
            new Coordinate(48.829397, 9.318508),
            new Coordinate(48.830857, 9.321046),
            new Coordinate(48.831646, 9.322622),
            new Coordinate(48.829657, 9.327122),
            new Coordinate(48.829058, 9.330364),
            new Coordinate(48.828698, 9.331470),
            new Coordinate(48.827779, 9.331899),
            new Coordinate(48.827537, 9.332886),
            new Coordinate(48.826194, 9.333494),
            new Coordinate(48.824036, 9.333406),
            new Coordinate(48.821745, 9.332124),
            new Coordinate(48.819953, 9.329918),
            new Coordinate(48.818857, 9.327409),
            new Coordinate(48.817938, 9.324175),
            new Coordinate(48.817458, 9.321070),
            new Coordinate(48.817212, 9.317285),
            new Coordinate(48.816538, 9.313039),
            new Coordinate(48.815466, 9.307233),
            new Coordinate(48.815283, 9.304244),
            new Coordinate(48.815337, 9.301181),
            new Coordinate(48.815152, 9.298829),
            new Coordinate(48.814750, 9.296986),
            new Coordinate(48.814131, 9.295264),
            new Coordinate(48.813217, 9.293573),
            new Coordinate(48.812095, 9.292188),
            new Coordinate(48.811115, 9.291361),
            new Coordinate(48.809897, 9.290712),
            new Coordinate(48.808293, 9.290362),
            new Coordinate(48.806055, 9.290179),
            new Coordinate(48.804819, 9.289682),
            new Coordinate(48.803409, 9.288423),
            new Coordinate(48.801418, 9.283106),
            new Coordinate(48.799225, 9.270779),
            new Coordinate(48.798875, 9.263569),
            new Coordinate(48.798235, 9.259128),
            new Coordinate(48.797225, 9.256331),
            new Coordinate(48.794716, 9.252484),
            new Coordinate(48.792624, 9.248728),
            new Coordinate(48.789540, 9.239401),
            new Coordinate(48.787825, 9.234649),
            new Coordinate(48.785454, 9.230660),
            new Coordinate(48.785553, 9.229556),
            new Coordinate(48.788508, 9.223442),
            new Coordinate(48.792147, 9.218064),
            new Coordinate(48.794909, 9.215496),
            new Coordinate(48.796555, 9.213890),
            new Coordinate(48.797253, 9.213094),
            new Coordinate(48.797432, 9.212356),
            new Coordinate(48.797515, 9.211132),
            new Coordinate(48.798114, 9.210300),
            new Coordinate(48.800472, 9.208994),
            new Coordinate(48.800968, 9.208722),
            new Coordinate(48.801449, 9.208176),
            new Coordinate(48.801980, 9.207687),
            new Coordinate(48.802433, 9.207096),
            new Coordinate(48.803186, 9.204520),
            new Coordinate(48.806298, 9.199606),
            new Coordinate(48.806893, 9.197947),
            new Coordinate(48.806938, 9.196030),
            new Coordinate(48.807206, 9.192158),
            new Coordinate(48.807765, 9.188946),
            new Coordinate(48.809962, 9.183980),
            new Coordinate(48.813903, 9.179174),
            new Coordinate(48.815832, 9.177677),
            new Coordinate(48.818491, 9.175922),
            new Coordinate(48.819677, 9.175584),
            new Coordinate(48.820301, 9.175110),
            new Coordinate(48.822147, 9.173570),
            new Coordinate(48.822800, 9.173035),
            new Coordinate(48.823746, 9.172814),
            new Coordinate(48.825535, 9.173368),
            new Coordinate(48.825743, 9.172648),
            new Coordinate(48.825884, 9.171038),
            new Coordinate(48.825712, 9.169323),
            new Coordinate(48.827993, 9.167072),
            new Coordinate(48.828977, 9.165564),
            new Coordinate(48.829860, 9.163559),
            new Coordinate(48.830648, 9.161690),
            new Coordinate(48.831646, 9.159353),
            new Coordinate(48.832459, 9.157398),
            new Coordinate(48.833020, 9.156121),
            new Coordinate(48.833719, 9.154621),
            new Coordinate(48.834794, 9.152561),
            DEALERSHIP
        );
        return createRoute("route-6", "Waiblingen Route",
            "From Waiblingen via B14 - Eastern approach (20.1 km, ~25 min)",
            waypoints, 20100, 1500);
    }

    // ==================== ROUTE 7: Fellbach ====================
    private DrivingRoute createRoute7FromFellbach() {
        List<Coordinate> waypoints = Arrays.asList(
            new Coordinate(48.809168, 9.275680),
            new Coordinate(48.809220, 9.274223),
            new Coordinate(48.809030, 9.271865),
            new Coordinate(48.808947, 9.270810),
            new Coordinate(48.808994, 9.269645),
            new Coordinate(48.810596, 9.269563),
            new Coordinate(48.812188, 9.269531),
            new Coordinate(48.813201, 9.269667),
            new Coordinate(48.813226, 9.268858),
            new Coordinate(48.812841, 9.266744),
            new Coordinate(48.812455, 9.264794),
            new Coordinate(48.812133, 9.263451),
            new Coordinate(48.810829, 9.256728),
            new Coordinate(48.810072, 9.252814),
            new Coordinate(48.809480, 9.249337),
            new Coordinate(48.808520, 9.243109),
            new Coordinate(48.808037, 9.241111),
            new Coordinate(48.807157, 9.237596),
            new Coordinate(48.806707, 9.235720),
            new Coordinate(48.806388, 9.234436),
            new Coordinate(48.806087, 9.232986),
            new Coordinate(48.805819, 9.231646),
            new Coordinate(48.805868, 9.231287),
            new Coordinate(48.806136, 9.230233),
            new Coordinate(48.805951, 9.229410),
            new Coordinate(48.805243, 9.226573),
            new Coordinate(48.804913, 9.225277),
            new Coordinate(48.804634, 9.224064),
            new Coordinate(48.804318, 9.222113),
            new Coordinate(48.803982, 9.220564),
            new Coordinate(48.803723, 9.219266),
            new Coordinate(48.803472, 9.217366),
            new Coordinate(48.803577, 9.216714),
            new Coordinate(48.803125, 9.216051),
            new Coordinate(48.802357, 9.215079),
            new Coordinate(48.800818, 9.212992),
            new Coordinate(48.800432, 9.212414),
            new Coordinate(48.799694, 9.210723),
            new Coordinate(48.799343, 9.209861),
            new Coordinate(48.799390, 9.209665),
            new Coordinate(48.800513, 9.209082),
            new Coordinate(48.800716, 9.208899),
            new Coordinate(48.801032, 9.208661),
            new Coordinate(48.801388, 9.208247),
            new Coordinate(48.801737, 9.207910),
            new Coordinate(48.802203, 9.207440),
            new Coordinate(48.802491, 9.206986),
            new Coordinate(48.803028, 9.205038),
            new Coordinate(48.804350, 9.202182),
            new Coordinate(48.806662, 9.198872),
            new Coordinate(48.806912, 9.197812),
            new Coordinate(48.806930, 9.196376),
            new Coordinate(48.807111, 9.193395),
            new Coordinate(48.807300, 9.191177),
            new Coordinate(48.807982, 9.188212),
            new Coordinate(48.809741, 9.184335),
            new Coordinate(48.812392, 9.180619),
            new Coordinate(48.814885, 9.178377),
            new Coordinate(48.815969, 9.177576),
            new Coordinate(48.818323, 9.176012),
            new Coordinate(48.819027, 9.175769),
            new Coordinate(48.819932, 9.175466),
            new Coordinate(48.820757, 9.174714),
            new Coordinate(48.822110, 9.173636),
            new Coordinate(48.822409, 9.173350),
            new Coordinate(48.823143, 9.172841),
            new Coordinate(48.823920, 9.172868),
            new Coordinate(48.825501, 9.173383),
            new Coordinate(48.825747, 9.172928),
            new Coordinate(48.825759, 9.171926),
            new Coordinate(48.825973, 9.170724),
            new Coordinate(48.825691, 9.169487),
            new Coordinate(48.826438, 9.168420),
            new Coordinate(48.828479, 9.166510),
            new Coordinate(48.829041, 9.165414),
            new Coordinate(48.829849, 9.163583),
            new Coordinate(48.830341, 9.162426),
            new Coordinate(48.830929, 9.161037),
            new Coordinate(48.831980, 9.158547),
            new Coordinate(48.832425, 9.157483),
            new Coordinate(48.832829, 9.156529),
            new Coordinate(48.833197, 9.155711),
            new Coordinate(48.833838, 9.154352),
            new Coordinate(48.834743, 9.152626),
            new Coordinate(48.835068, 9.152165),
            DEALERSHIP
        );
        return createRoute("route-7", "Fellbach Route",
            "From Fellbach via B14 - Wine country start (12.1 km, ~21 min)",
            waypoints, 12100, 1260);
    }

    // ==================== ROUTE 8: Esslingen ====================
    private DrivingRoute createRoute8FromEsslingen() {
        List<Coordinate> waypoints = Arrays.asList(
            new Coordinate(48.740781, 9.305013),
            new Coordinate(48.741340, 9.303797),
            new Coordinate(48.741585, 9.302421),
            new Coordinate(48.741950, 9.299972),
            new Coordinate(48.742456, 9.296793),
            new Coordinate(48.742579, 9.296029),
            new Coordinate(48.742974, 9.295864),
            new Coordinate(48.742824, 9.294807),
            new Coordinate(48.742376, 9.292222),
            new Coordinate(48.742093, 9.289665),
            new Coordinate(48.741752, 9.286833),
            new Coordinate(48.741713, 9.285753),
            new Coordinate(48.742091, 9.283670),
            new Coordinate(48.742599, 9.281954),
            new Coordinate(48.743169, 9.280610),
            new Coordinate(48.743900, 9.279359),
            new Coordinate(48.743282, 9.278057),
            new Coordinate(48.742476, 9.276900),
            new Coordinate(48.741742, 9.276172),
            new Coordinate(48.741027, 9.275694),
            new Coordinate(48.740731, 9.275011),
            new Coordinate(48.741046, 9.273142),
            new Coordinate(48.741424, 9.271754),
            new Coordinate(48.742383, 9.269687),
            new Coordinate(48.743666, 9.267840),
            new Coordinate(48.744894, 9.266741),
            new Coordinate(48.745966, 9.266146),
            new Coordinate(48.747651, 9.265514),
            new Coordinate(48.749018, 9.264920),
            new Coordinate(48.750743, 9.263859),
            new Coordinate(48.752964, 9.262296),
            new Coordinate(48.757065, 9.259438),
            new Coordinate(48.767339, 9.252644),
            new Coordinate(48.773458, 9.248032),
            new Coordinate(48.776514, 9.244916),
            new Coordinate(48.780988, 9.238365),
            new Coordinate(48.786027, 9.228348),
            new Coordinate(48.789501, 9.221615),
            new Coordinate(48.792402, 9.217814),
            new Coordinate(48.794909, 9.215496),
            new Coordinate(48.796386, 9.214037),
            new Coordinate(48.797200, 9.213214),
            new Coordinate(48.797403, 9.212623),
            new Coordinate(48.797451, 9.211536),
            new Coordinate(48.797630, 9.210849),
            new Coordinate(48.798445, 9.210021),
            new Coordinate(48.800546, 9.208969),
            new Coordinate(48.800968, 9.208722),
            new Coordinate(48.801388, 9.208247),
            new Coordinate(48.801823, 9.207834),
            new Coordinate(48.802276, 9.207339),
            new Coordinate(48.802671, 9.206508),
            new Coordinate(48.803783, 9.203095),
            new Coordinate(48.806572, 9.199093),
            new Coordinate(48.806912, 9.197812),
            new Coordinate(48.806938, 9.196030),
            new Coordinate(48.807182, 9.192441),
            new Coordinate(48.807549, 9.189841),
            new Coordinate(48.809040, 9.185613),
            new Coordinate(48.811911, 9.181087),
            new Coordinate(48.814885, 9.178377),
            new Coordinate(48.816489, 9.177224),
            new Coordinate(48.818603, 9.175873),
            new Coordinate(48.819677, 9.175584),
            new Coordinate(48.820207, 9.175186),
            new Coordinate(48.822084, 9.173670),
            new Coordinate(48.822409, 9.173350),
            new Coordinate(48.823261, 9.172801),
            new Coordinate(48.824684, 9.173131),
            new Coordinate(48.825655, 9.173299),
            new Coordinate(48.825750, 9.172474),
            new Coordinate(48.825884, 9.171038),
            new Coordinate(48.825691, 9.169487),
            new Coordinate(48.827414, 9.167598),
            new Coordinate(48.828726, 9.166105),
            new Coordinate(48.829366, 9.164683),
            new Coordinate(48.830247, 9.162647),
            new Coordinate(48.830893, 9.161121),
            new Coordinate(48.831980, 9.158547),
            new Coordinate(48.832459, 9.157398),
            new Coordinate(48.832886, 9.156407),
            new Coordinate(48.833401, 9.155250),
            new Coordinate(48.834369, 9.153292),
            new Coordinate(48.835054, 9.152260),
            DEALERSHIP
        );
        return createRoute("route-8", "Esslingen Route",
            "From Esslingen via B10 - Historic town start (17.3 km, ~26 min)",
            waypoints, 17300, 1560);
    }

    // ==================== HELPER METHODS ====================
    private DrivingRoute createRoute(String id, String name, String description,
                                     List<Coordinate> waypoints, double distanceMeters, int durationSeconds) {
        Coordinate start = waypoints.get(0);
        Coordinate end = waypoints.get(waypoints.size() - 1);
        return new DrivingRoute(id, name, description, start, end, waypoints, distanceMeters, durationSeconds);
    }

    @Override
    @Transactional(readOnly = true)
    public List<DrivingRoute> findAll() {
        return jpaRouteRepository.findAll().stream()
                .map(routeEntityMapper::toDomain)
                .toList();
    }

    @Override
    @Transactional(readOnly = true)
    public Optional<DrivingRoute> findById(String routeId) {
        return jpaRouteRepository.findById(routeId)
                .map(routeEntityMapper::toDomain);
    }

    @Override
    public int count() {
        return (int) jpaRouteRepository.count();
    }
}
